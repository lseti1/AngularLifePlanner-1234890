<div class="absolute flex items-center left-0 top-0 w-full h-full justify-center bg-black/5">
    <form #form="ngForm" (ngSubmit)="onSubmit(form)" class="relative flex flex-col justify-start items-start bg-white w-[50%] h-[55%] shadow-sm p-8 gap-4">
        <div class="flex w-full justify-between items-center">
            <div>
                <h1 class="text-xl">{{ months[selectedMonthIndex] }} {{ selectedDateIndex | ordinalPipe }} </h1>
                <p class="text-gray-400 text-sm">{{ selectedDatePlans().length }} Total Plans</p>
            </div>
            <fa-icon [icon]="selectionViewType() === 'adding' ? faCalendarFinished : faCalendarAdd"  [ngClass]="{'hidden' : validSelectedPlan(), 'text-blue-600' : selectionViewType() !== 'adding' }" (click)="toggleSelectionView('adding')" class="text-2xl cursor-pointer"></fa-icon>
        </div>
        <div class="w-full overflow-auto h-full">
            <ul class="flex flex-col break-words w-full gap-1 h-full">
                    @for (plan of selectedDatePlans(); track plan.id) {
                        <li (click)="onSelectPlan(plan.id)" class="flex flex-col border bg-gray-100 px-1 py-2 gap-2 hover:bg-gray-200 cursor-pointer">
                            <div class="flex flex-row justify-between w-full">
                                <div class="grid grid-cols-[auto_3fr_2fr] items-center justify-start w-full">
                                    <fa-icon
                                        class="mx-2"
                                        (click)="onMarkPlanComplete(plan.id, selectedDateIndex, selectedMonthIndex, $event)"
                                        [icon]="plan.completed ? faCheckCircle : faCheckCircleRegular">
                                    </fa-icon>
                                    <div class="w-full overflow-hidden">
                                        <p class="truncate text">{{ plan.title }}</p>
                                        <p class="truncate text-xs text-gray-400">{{ plan.description }}</p>
                                    </div>
                                    <div class="flex justify-end px-2">
                                        <fa-icon type="button" class="text-lg text-red-600 cursor-pointer" (click)="onRemovePlan(plan.id, selectedDateIndex, selectedMonthIndex, $event)" [icon]="faDelete">Delete</fa-icon>
                                    </div>
                                </div>
                            </div>
                        </li>
                    } 
                    @if (selectedDatePlans().length === 0) {
                        <div class="flex items-center justify-center w-full h-full">
                            <p class="text-gray-400 text-center">No plans added for this date.</p>
                        </div>  
                    }
            </ul>
        </div>
        <div [ngClass]="{'hidden' : selectionViewType() !== 'adding'}" class="w-full flex flex-row gap-2">
            <div class="flex relative border w-full">
                <input [(ngModel)]="plan" name="planText" id="planText" type="text" class="bg-white w-full px-2" placeholder="Add Plan Here..." maxlength="50"/>
                <fa-icon [icon]="faDelete" [ngClass]="{'hidden' : plan === '' }" type="button" class="flex absolute items-center justify-end w-full h-full px-2 cursor-pointer" (click)="onClear()">X</fa-icon>
            </div>
            <fa-icon [icon]="faCalendarAdd" [ngClass]="{'opacity-20 pointer-events-none' : plan === '' }" (click)="onAddPlan(selectedDateIndex, selectedMonthIndex, plan)" class="text-2xl cursor-pointer text-blue-600"></fa-icon>
        </div>
        <button type="submit" class="absolute top-2 right-4 font-semibold">X</button>
    </form>
</div>
